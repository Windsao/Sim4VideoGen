Loading models from: ['/nyx-storage1/hanliu/world_model_ckpt/Wan-AI/Wan2.2-TI2V-5B/diffusion_pytorch_model-00001-of-00003-bf16.safetensors', '/nyx-storage1/hanliu/world_model_ckpt/Wan-AI/Wan2.2-TI2V-5B/diffusion_pytorch_model-00002-of-00003-bf16.safetensors', '/nyx-storage1/hanliu/world_model_ckpt/Wan-AI/Wan2.2-TI2V-5B/diffusion_pytorch_model-00003-of-00003-bf16.safetensors']
    model_name: wan_video_dit model_class: WanModel
        This model is initialized with extra kwargs: {'has_image_input': False, 'patch_size': [1, 2, 2], 'in_dim': 48, 'dim': 3072, 'ffn_dim': 14336, 'freq_dim': 256, 'text_dim': 4096, 'out_dim': 48, 'num_heads': 24, 'num_layers': 30, 'eps': 1e-06, 'seperated_timestep': True, 'require_clip_embedding': False, 'require_vae_embedding': False, 'fuse_vae_embedding_in_latents': True}
    The following models are loaded: ['wan_video_dit'].
Loading models from: /nyx-storage1/hanliu/world_model_ckpt/Wan-AI/Wan2.2-TI2V-5B/models_t5_umt5-xxl-enc-bf16.pth
    model_name: wan_video_text_encoder model_class: WanTextEncoder
    The following models are loaded: ['wan_video_text_encoder'].
Loading models from: /nyx-storage1/hanliu/world_model_ckpt/Wan-AI/Wan2.2-TI2V-5B/Wan2.2_VAE.pth
    model_name: wan_video_vae model_class: WanVideoVAE38
    The following models are loaded: ['wan_video_vae'].
Using wan_video_text_encoder from /nyx-storage1/hanliu/world_model_ckpt/Wan-AI/Wan2.2-TI2V-5B/models_t5_umt5-xxl-enc-bf16.pth.
Using wan_video_dit from ['/nyx-storage1/hanliu/world_model_ckpt/Wan-AI/Wan2.2-TI2V-5B/diffusion_pytorch_model-00001-of-00003-bf16.safetensors', '/nyx-storage1/hanliu/world_model_ckpt/Wan-AI/Wan2.2-TI2V-5B/diffusion_pytorch_model-00002-of-00003-bf16.safetensors', '/nyx-storage1/hanliu/world_model_ckpt/Wan-AI/Wan2.2-TI2V-5B/diffusion_pytorch_model-00003-of-00003-bf16.safetensors'].
Using wan_video_vae from /nyx-storage1/hanliu/world_model_ckpt/Wan-AI/Wan2.2-TI2V-5B/Wan2.2_VAE.pth.
No wan_video_image_encoder models available.
No wan_video_motion_controller models available.
No wan_video_vace models available.
No wans2v_audio_encoder models available.
Loading motion head checkpoint from /nyx-storage1/hanliu/world_model_ckpt/Wan-AI/wan22_ti2v_stage1/final/motion_head.pth
✓ Motion head checkpoint loaded (3 tensors)
Motion head initialized with 4 channels
Standard depth head initialized
Loading depth head checkpoint from /nyx-storage1/hanliu/world_model_ckpt/Wan-AI/wan22_ti2v_stage1/final/depth_head.pth
✓ Depth head checkpoint loaded (3 tensors)
============================================================
TRAINING MODE: LoRA + Heads (Stage 2)
============================================================
✓ Motion head: TRAINABLE
✓ Depth head: TRAINABLE
[INFO] Trainable params: 606 tensors
[INFO] DiT trainable params are LoRA-only
✓ DiT backbone: LoRA (rank=32)
============================================================
[INFO] Optimizer params: 606 tensors (requires_grad=True)
Epoch 1/5:   3%|▏   | 18/525 [01:03<29:32,  3.50s/it, loss=0.4474, noise=1.0695, motion=0.0313, depth=0.7952]
